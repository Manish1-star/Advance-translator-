<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Advance Translator â€” MwniX</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;
      background:linear-gradient(135deg,#0f172a,#111827);
      color:#e6eef8;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .card{
      width:100%;
      max-width:920px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      padding:22px;
      box-shadow:0 10px 40px rgba(2,6,23,0.6);
    }
    h1{margin:0 0 10px;font-size:28px;text-align:center;
      background:linear-gradient(90deg,#60a5fa,#c084fc);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:16px;margin-top:18px;}
    @media(max-width:880px){.grid{grid-template-columns:1fr;}}
    textarea{
      width:100%;min-height:180px;padding:14px;border-radius:10px;border:none;resize:vertical;
      background:rgba(255,255,255,0.03);color:inherit;font-size:15px;outline:none;
    }
    .controls{display:flex;flex-direction:column;gap:10px;}
    select,input,button{width:100%;padding:12px;border-radius:10px;border:none;font-weight:600;}
    select, input{background:rgba(255,255,255,0.03);color:inherit}
    .btn-row{display:flex;gap:10px;flex-wrap:wrap;}
    .btn{flex:1;padding:12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:#6366f1;color:white}
    .btn-accent{background:#ec4899;color:white}
    .btn-green{background:#10b981;color:white}
    .btn-yellow{background:#f59e0b;color:white}
    .result{
      margin-top:14px;padding:14px;border-radius:10px;background:rgba(255,255,255,0.02);
      min-height:120px;font-size:16px;line-height:1.5;
    }
    .small{font-size:13px;opacity:0.8}
    .footer{margin-top:14px;text-align:center;font-size:13px;opacity:0.85}
  </style>
</head>
<body>
  <div class="card">
    <h1>Advance Translator â€” MwniX</h1>
    <div class="grid">
      <div>
        <textarea id="inputText" placeholder="Type or paste text here..."></textarea>

        <div class="btn-row" style="margin-top:12px">
          <button class="btn btn-accent" id="micBtn">ðŸŽ¤ Speak</button>
          <button class="btn btn-primary" id="translateBtn">Translate</button>
          <button class="btn btn-yellow" id="copyBtn">ðŸ“‹ Copy</button>
        </div>

        <div class="result" id="resultBox">Translation will appear here...</div>
      </div>

      <div class="controls">
        <label class="small">Target language</label>
        <select id="targetLang">
          <option value="en">English</option>
          <option value="ne">Nepali</option>
          <option value="hi">Hindi</option>
          <option value="es">Spanish</option>
          <option value="fr">French</option>
          <option value="de">German</option>
          <option value="zh-CN">Chinese (Simplified)</option>
          <option value="ja">Japanese</option>
          <option value="ko">Korean</option>
          <option value="ru">Russian</option>
          <option value="pt">Portuguese</option>
          <option value="it">Italian</option>
        </select>

        <label class="small" style="margin-top:10px">Voice (listen)</label>
        <select id="voiceLang">
          <option value="auto">Auto (browser)</option>
          <option value="en-US">English (US)</option>
          <option value="ne-NP">Nepali</option>
          <option value="hi-IN">Hindi</option>
          <option value="es-ES">Spanish</option>
          <option value="fr-FR">French</option>
          <option value="de-DE">German</option>
          <option value="zh-CN">Chinese (Simplified)</option>
          <option value="ja-JP">Japanese</option>
        </select>

        <button class="btn btn-green" id="listenBtn" style="margin-top:12px">ðŸ”Š Listen</button>

        <div class="footer">
          Uses free MyMemory API â€¢ No API key needed â€¢ Works on GitHub Pages
        </div>
      </div>
    </div>
  </div>

<script>
const inputText = document.getElementById('inputText');
const resultBox = document.getElementById('resultBox');
const translateBtn = document.getElementById('translateBtn');
const copyBtn = document.getElementById('copyBtn');
const micBtn = document.getElementById('micBtn');
const listenBtn = document.getElementById('listenBtn');
const targetLang = document.getElementById('targetLang');
const voiceLang = document.getElementById('voiceLang');

translateBtn.addEventListener('click', translateText);
copyBtn.addEventListener('click', copyResult);
listenBtn.addEventListener('click', speakResult);
micBtn.addEventListener('click', startMic);

async function translateText(){
  const text = inputText.value.trim();
  if(!text){
    resultBox.innerText = 'Please enter text to translate.';
    return;
  }
  resultBox.innerText = 'Translating...';
  try{
    // MyMemory free API
    const target = targetLang.value;
    const q = encodeURIComponent(text);
    const url = `https://api.mymemory.translated.net/get?q=${q}&langpair=auto|${encodeURIComponent(target)}`;

    const res = await fetch(url);
    if(!res.ok) throw new Error('Network response not ok');
    const data = await res.json();

    // primary translated text
    let translated = (data && data.responseData && data.responseData.translatedText) ? data.responseData.translatedText : '';

    // fallback: try matches or segments if available
    if(!translated && data.matches && data.matches.length){
      translated = data.matches[0].translation || data.matches[0].segment || '';
    }

    if(!translated) translated = 'Translation not available.';

    resultBox.innerText = translated;
  }catch(err){
    console.error(err);
    resultBox.innerText = 'No internet or translation failed.';
  }
}

function copyResult(){
  const text = resultBox.innerText || '';
  if(!text) return alert('Nothing to copy.');
  navigator.clipboard.writeText(text).then(()=> alert('Copied!'), ()=> alert('Copy failed.'));
}

function speakResult(){
  const text = resultBox.innerText || '';
  if(!text || text.includes('Translating')) return;
  const synth = window.speechSynthesis;
  const utter = new SpeechSynthesisUtterance(text);
  const v = voiceLang.value;
  if(v !== 'auto') utter.lang = v;
  // try to pick a voice matching lang (if available)
  const voices = synth.getVoices();
  if(voices && voices.length){
    let found = voices.find(x => x.lang && (v==='auto' ? x.default : x.lang.startsWith(v.split('-')[0])));
    if(found) utter.voice = found;
  }
  synth.speak(utter);
}

function startMic(){
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SpeechRecognition){
    alert('Speech recognition not supported on this device/browser.');
    return;
  }
  const rec = new SpeechRecognition();
  rec.lang = 'en-US';
  rec.interimResults = false;
  rec.maxAlternatives = 1;
  rec.start();
  micBtn.innerText = 'ðŸŽ™ï¸ Listening...';
  rec.onresult = (ev) => {
    const txt = ev.results[0][0].transcript;
    inputText.value = txt;
  };
  rec.onerror = ()=> { micBtn.innerText = 'ðŸŽ¤ Speak'; };
  rec.onend = ()=> { micBtn.innerText = 'ðŸŽ¤ Speak'; };
}
</script>
</body>
</html>
